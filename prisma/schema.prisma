generator kysely {
  provider = "prisma-kysely"
  output   = "../packages/core/src"
  fileName = "db.ts"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Experiment {
  name       String               @id
  createdAt  DateTime             @default(now())
  updatedAt  DateTime?
  rangeStart Int
  rangeEnd   Int
  overrides  ExperimentOverride[]
}

model ExperimentOverride {
  id             Int        @id @default(autoincrement())
  guildId        String
  experimentName String
  experiment     Experiment @relation(fields: [experimentName], references: [name])

  @@unique([guildId, experimentName])
}

model Incident {
  id        Int      @id @default(autoincrement())
  stack     String
  guildId   String?
  createdAt DateTime @default(now())
  resolved  Boolean  @default(false)
}

enum ModCaseKind {
  Warn
  Timeout
  Kick
  Ban
  Untimeout
  Unban
}

model ModCase {
  id        Int         @id @default(autoincrement())
  guildId   String
  kind      ModCaseKind
  createdAt DateTime    @default(now())
  reason    String
  modId     String
  targetId  String
}

enum LogWebhookKind {
  Mod
}

model LogWebhook {
  id           Int            @id @default(autoincrement())
  guildId      String
  webhookId    String
  webhookToken String
  threadId     String?
  kind         LogWebhookKind
}
